{"version":3,"file":"MouseEdges.js","sourceRoot":"","sources":["../../src/plugins/MouseEdges.ts"],"names":[],"mappings":"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","sourcesContent":["import { Plugin } from './Plugin';\n\nimport type { Viewport } from '../Viewport';\nimport type { FederatedPointerEvent } from '@pixi/events';\n\n/** Insets for mouse edges scrolling regions */\nexport interface IMouseEdgesInsets\n{\n    /** Distance from center of screen in screen pixels */\n    radius?: number | null;\n\n    /** Distance from all sides in screen pixels */\n    distance?: number | null;\n\n    /** Alternatively, set top distance (leave unset for no top scroll) */\n    top?: number | null;\n\n    /** Alternatively, set bottom distance (leave unset for no top scroll) */\n    bottom?: number | null;\n\n    /** Alternatively, set left distance (leave unset for no top scroll) */\n    left?: number | null;\n\n    /** Alternatively, set right distance (leave unset for no top scroll) */\n    right?: number | null;\n}\n\n/** Options for {@link MouseEdges}. */\nexport interface IMouseEdgesOptions extends IMouseEdgesInsets\n{\n    /** Speed in pixels/frame to scroll viewport */\n    speed?: number;\n\n    /** Reverse direction of scroll */\n    reverse?: boolean;\n\n    /** Don't use decelerate plugin even if it's installed */\n    noDecelerate?: boolean;\n\n    /**\n     * If using radius, use linear movement (+/- 1, +/- 1) instead of angled movement.\n     *\n     * (Math.cos(angle from center), Math.sin(angle from center))\n     */\n    linear?: boolean;\n\n    /** Allows plugin to continue working even when there's a `mousedown` event. */\n    allowButtons?: boolean;\n}\n\nconst MOUSE_EDGES_OPTIONS: Required<IMouseEdgesOptions> = {\n    radius: null,\n    distance: null,\n    top: null,\n    bottom: null,\n    left: null,\n    right: null,\n    speed: 8,\n    reverse: false,\n    noDecelerate: false,\n    linear: false,\n    allowButtons: false,\n};\n\n/**\n * Scroll viewport when mouse hovers near one of the edges.\n *\n * @event mouse-edge-start(Viewport) emitted when mouse-edge starts\n * @event mouse-edge-end(Viewport) emitted when mouse-edge ends\n */\nexport class MouseEdges extends Plugin\n{\n    /** Options used to initialize this plugin, cannot be modified later. */\n    public readonly options: Readonly<Required<IMouseEdgesOptions>>;\n\n    /** Factor from reverse option. */\n    protected readonly reverse: -1 | 1;\n\n    /** Radius squared */\n    protected readonly radiusSquared: number | null;\n\n    /** Scroll region size on the left side. */\n    protected left!: number | null;\n\n    /** Scroll region size on the top size. */\n    protected top!: number | null;\n\n    /** Scroll region size on the right side. */\n    protected right!: number | null;\n\n    /** Scroll region size on the bottom side. */\n    protected bottom!: number | null;\n\n    protected horizontal?: number | null;\n\n    protected vertical?: number | null;\n\n    /**\n     * This is called by {@link Viewport.mouseEdges}.\n     */\n    constructor(parent: Viewport, options: IMouseEdgesOptions = {})\n    {\n        super(parent);\n\n        this.options = Object.assign({}, MOUSE_EDGES_OPTIONS, options);\n        this.reverse = this.options.reverse ? 1 : -1;\n        this.radiusSquared = typeof this.options.radius === 'number' ? Math.pow(this.options.radius, 2) : null;\n\n        this.resize();\n    }\n\n    public resize(): void\n    {\n        const distance = this.options.distance;\n\n        if (distance !== null)\n        {\n            this.left = distance;\n            this.top = distance;\n            this.right = this.parent.screenWidth - distance;\n            this.bottom = this.parent.screenHeight - distance;\n        }\n        else if (!this.options.radius)\n        {\n            this.left = this.options.left;\n            this.top = this.options.top;\n            this.right = this.options.right === null ? null : this.parent.screenWidth - this.options.right;\n            this.bottom = this.options.bottom === null ? null : this.parent.screenHeight - this.options.bottom;\n        }\n    }\n\n    public down(): boolean\n    {\n        if (this.paused)\n        {\n            return false;\n        }\n        if (!this.options.allowButtons)\n        {\n            this.horizontal = this.vertical = null;\n        }\n\n        return false;\n    }\n\n    public move(event: FederatedPointerEvent): boolean\n    {\n        if (this.paused)\n        {\n            return false;\n        }\n        if ((event.pointerType !== 'mouse' && event.pointerId !== 1)\n            || (!this.options.allowButtons && event.buttons !== 0))\n        {\n            return false;\n        }\n\n        const x = event.global.x;\n        const y = event.global.y;\n\n        if (this.radiusSquared)\n        {\n            const center = this.parent.toScreen(this.parent.center);\n            const distance = Math.pow(center.x - x, 2) + Math.pow(center.y - y, 2);\n\n            if (distance >= this.radiusSquared)\n            {\n                const angle = Math.atan2(center.y - y, center.x - x);\n\n                if (this.options.linear)\n                {\n                    this.horizontal = Math.round(Math.cos(angle)) * this.options.speed * this.reverse * (60 / 1000);\n                    this.vertical = Math.round(Math.sin(angle)) * this.options.speed * this.reverse * (60 / 1000);\n                }\n                else\n                {\n                    this.horizontal = Math.cos(angle) * this.options.speed * this.reverse * (60 / 1000);\n                    this.vertical = Math.sin(angle) * this.options.speed * this.reverse * (60 / 1000);\n                }\n            }\n            else\n            {\n                if (this.horizontal)\n                {\n                    this.decelerateHorizontal();\n                }\n                if (this.vertical)\n                {\n                    this.decelerateVertical();\n                }\n\n                this.horizontal = this.vertical = 0;\n            }\n        }\n        else\n        {\n            if (this.left !== null && x < this.left)\n            {\n                this.horizontal = Number(this.reverse) * this.options.speed * (60 / 1000);\n            }\n            else if (this.right !== null && x > this.right)\n            {\n                this.horizontal = -1 * this.reverse * this.options.speed * (60 / 1000);\n            }\n            else\n            {\n                this.decelerateHorizontal();\n                this.horizontal = 0;\n            }\n            if (this.top !== null && y < this.top)\n            {\n                this.vertical = Number(this.reverse) * this.options.speed * (60 / 1000);\n            }\n            else if (this.bottom !== null && y > this.bottom)\n            {\n                this.vertical = -1 * this.reverse * this.options.speed * (60 / 1000);\n            }\n            else\n            {\n                this.decelerateVertical();\n                this.vertical = 0;\n            }\n        }\n\n        return false;\n    }\n\n    private decelerateHorizontal(): void\n    {\n        const decelerate = this.parent.plugins.get('decelerate', true);\n\n        if (this.horizontal && decelerate && !this.options.noDecelerate)\n        {\n            decelerate.activate({ x: (this.horizontal * this.options.speed * this.reverse) / (1000 / 60) });\n        }\n    }\n\n    private decelerateVertical(): void\n    {\n        const decelerate = this.parent.plugins.get('decelerate', true);\n\n        if (this.vertical && decelerate && !this.options.noDecelerate)\n        {\n            decelerate.activate({ y: (this.vertical * this.options.speed * this.reverse) / (1000 / 60) });\n        }\n    }\n\n    public up(): boolean\n    {\n        if (this.paused)\n        {\n            return false;\n        }\n        if (this.horizontal)\n        {\n            this.decelerateHorizontal();\n        }\n        if (this.vertical)\n        {\n            this.decelerateVertical();\n        }\n        this.horizontal = this.vertical = null;\n\n        return false;\n    }\n\n    public update(): void\n    {\n        if (this.paused)\n        {\n            return;\n        }\n\n        if (this.horizontal || this.vertical)\n        {\n            const center = this.parent.center;\n\n            if (this.horizontal)\n            {\n                center.x += this.horizontal * this.options.speed;\n            }\n            if (this.vertical)\n            {\n                center.y += this.vertical * this.options.speed;\n            }\n\n            this.parent.moveCenter(center);\n            this.parent.emit('moved', { viewport: this.parent, type: 'mouse-edges' });\n        }\n    }\n}\n"]}